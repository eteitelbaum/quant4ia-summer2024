{
  "hash": "1d13cded0360b0409190f5fd3903af49",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Linear Regression\ndate: today\ndate-format: long\nfooter: \"[IAFF 6501 Website](https://quant4ia.rocks/)\"\nlogo: images/iaff6501-logo.png\nformat:\n  revealjs:\n    theme: [simple, custom.scss]\n    transition: fade\n    slide-number: true\n    #multiplex: true\n    chalkboard: true\nexecute:\n  echo: false\n  message: false\n  warning: false\n  freeze: auto\n---\n\n::: {.cell}\n\n:::\n\n\n## Modeling \n\n::: {.incremental}\n- Use models to explain the relationship between variables and to make predictions\n- Explaining relationships (usually interested in causal relationships, but not always)\n    - Does oil wealth impact regime type?\n- Predictive modeling\n    - Where is violence most likely to happen in (country X) during their next election?\n    - Is this email spam?\n:::\n    \n## Modeling\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/linear-model-1.png){width=960}\n:::\n:::\n\n\n## Modeling\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/nonlinear-model-1.png){width=960}\n:::\n:::\n\n\n# Example: GDP per capita and Democracy\n\n## Pull in the VDEM Data\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vdemdata)\n\nmodelData <- vdem |>\n  filter(year == 2019) |> \n  select(\n    country = country_name, \n    lib_dem = v2x_libdem, \n    wealth = e_gdppc) |>\n  mutate(log_wealth = log(wealth))\n\nglimpse(modelData)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 179\nColumns: 4\n$ country    <chr> \"Mexico\", \"Suriname\", \"Sweden\", \"Switzerland\", \"Ghana\", \"So…\n$ lib_dem    <dbl> 0.434, 0.580, 0.871, 0.866, 0.615, 0.607, 0.755, 0.260, 0.1…\n$ wealth     <dbl> 16.814, 11.752, 48.804, 56.110, 5.608, 11.345, 39.061, 5.69…\n$ log_wealth <dbl> 2.8222119, 2.4640234, 3.8878123, 4.0273140, 1.7241941, 2.42…\n```\n\n\n:::\n:::\n\n\n## Plot the Relationship\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/plot-wealth-dem-1-1.png){width=960}\n:::\n:::\n\n\n## Plot the Relationship\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/plot-wealth-dem-2-1.png){width=960}\n:::\n:::\n\n\n## Plot the Relationship\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(modelData, aes(x = wealth, y = lib_dem)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", color = \"#E48957\", se = FALSE) +\n  labs(x = \"GPD per capita\", y = \"Liberal Democracy Index\") +\n  theme_bw()\n```\n:::\n\n\n## Using the Scales Package\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/plot-wealth-dem-4-1.png){width=960}\n:::\n:::\n\n\n## Using the Scales Package\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"1,4\"}\nggplot(modelData, aes(x = wealth, y = lib_dem)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", color = \"#E48957\", se = FALSE) +\n  scale_x_log10(label = scales::label_dollar(suffix = \"k\")) +\n  labs(\n    title = \"Wealth and Democracy, 2019\",\n    x = \"GPD per capita\", \n    y = \"Liberal Democracy Index\") +\n  theme_bw()\n```\n:::\n\n\n## Models as Functions\n\n::: {.incremental}\n- We can represent relationships between variables using **functions**\n- A function is a rule or set of rules that maps input values to output values\n  - Plug in the inputs and receive back the output\n- Example: The formula $y = 3x + 7$ is a function with input $x$ and output $y$ \n    - If $x$ is $5$, $y$ is $22$\n    - $y = 3 \\times 5 + 7 = 22$\n:::\n\n## Quant Lingo {.smaller}\n\n<br>\n\n::: {.incremental}\n- **Response variable:** Variable whose behavior or variation you are trying to understand, on the y-axis in the plot (the **output**)\n    - **Dependent** variable\n    - **Outcome** variable\n    - **Y** variable\n- **Explanatory variables:** Other variables that you want to use to explain the variation in the response, on the x-axis in the plot (the **input**)\n    - **Independent** variables\n    - **Predictors**\n:::\n\n## \n\n<br>\n\nLinear model with one explanatory variable...\n\n::: {.incremental}\n- $Y = a + bX$\n- $Y$ is the outcome variable\n- $X$ is the explanatory variable\n- $a$ is the intercept: the predicted value of $Y$ when $X$ is equal to 0\n- $b$ is the slope of the line (remember rise over run!)\n:::\n\n## Quant Lingo {.smaller}\n\n<br>\n\n::: {.incremental}\n- **Predicted value:** Output of the **model function**\n   - The model function gives the typical (expected) value of the response variable *conditioning* on the explanatory variables\n   - We often call this $\\hat{Y}$ to differentiate the predicted value from an observed value of Y in the data\n- **Residuals:** A measure of how far each case is from its predicted value (based on a particular model)\n  - Residual = Observed value ($Y$) - Predicted value ($\\hat{Y}$)\n  - How far above/below the expected value each case is\n:::\n\n## Residuals\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/unnamed-chunk-10-1.png){width=60%}\n:::\n:::\n\n\n## Linear Model\n\n$\\hat{Y} = a  + b \\times X$\n\n$\\hat{Y} = 0.13  + 0.12 \\times X$\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/unnamed-chunk-11-1.png){width=100%}\n:::\n:::\n\n\n## Linear Model: Interpretation\n\n<br>\n\n| $\\hat{Y} = a  + b \\times X$\n| $\\hat{Y} = 0.13  + 0.12 \\times X$\n\nWhat is the interpretation of our estimate of $a$?\n\n. . .\n\n<br>\n\n| $\\hat{Y} = 0.13  + 0.12 \\times 0$\n| $\\hat{Y} = 0.13$\n\n$a$ is our predicted level of democracy when GDP per capita is 0.\n\n\n## Linear Model: Interpretation \n<br>\n\n\n| $\\hat{Y} = a  + b \\times X$\n| $\\hat{Y} = 0.13  + 0.12 \\times X$\n\nWhat is interpretation of our estimate of $b$?\n\n. . . \n\n<br>\n\n| $\\hat{Y} = a  + \\frac{Rise}{Run} \\times X$\n| $\\hat{Y} = a  + \\frac{Change Y}{Change X} \\times X$\n\n## Linear Model: Interpretation {.smaller}\n\n<br>\n\n| $b = \\frac{Change Y}{Change X}$\n| $0.12 = \\frac{Change Y}{Change X}$\n| ${Change Y} = 0.12 * {ChangeX}$\n\n. . .\n\n<br>\n\n| When $ChangeX = 1$:\n| ${Change Y = 0.12}$\n\n. . .\n\n<br>\n\n| $b$ is the predicted change in $Y$ **associated with** a ONE unit change in X.\n\n## Linear Model: Interpretation\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n## Linear Model: Interpretation\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n\n## Linear Model: Interpretation\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\n\n## Linear Model: Interpretation\n\n<br>\n\nIs this the **causal** effect of GDP per capita on liberal democracy?\n\n. . .\n\n<br>\n\nNo! It is only the association...\n\n. . .\n\n<br>\n\nTo identify causality we need other methods (beyond the scope of this course).\n\n## Your Task\n\n<br> \n\nAn economist is interested in the relationship between years of education and hourly wages.  They estimate a linear model with estimates of $a$ and $b$ as follows:\n\n<br>\n\n$\\hat{Y} = 9 + 1.60*{YrsEdu}$\n\n<br>\n\n| 1. Interpret $a$ and $b$\n| 2. What is the predicted hourly wage for those with 10 years of education?\n\n## Next step\n\n<br>\n\n- Linear model with one predictor: $Y = a + bX$\n- For any given data...\n- How do we figure out what the best values are for $a$ and $b$??\n\n# Estimation\n\n## Linear Model with Single Predictor\n\n<br>\n\nGoal: Estimate Democracy score ($\\hat{Y_{i}}$) of a country given level of GDP per capita ($X_{i}$).\n\n<br>\n\nOr: Estimate relationship between GDP per capita and democracy.\n\n## Linear Model with Single Predictor\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/model-data-1.png){width=960}\n:::\n:::\n\n\n# Estimate Model \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <-  lm(lib_dem ~ log_wealth, data = modelData) \n\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = lib_dem ~ log_wealth, data = modelData)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.57441 -0.14334  0.03911  0.18730  0.37017 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  0.13051    0.03806   3.429 0.000758 ***\nlog_wealth   0.12040    0.01471   8.188 5.75e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2233 on 172 degrees of freedom\n  (5 observations deleted due to missingness)\nMultiple R-squared:  0.2805,\tAdjusted R-squared:  0.2763 \nF-statistic: 67.04 on 1 and 172 DF,  p-value: 5.754e-14\n```\n\n\n:::\n:::\n\n\n## \n\nIn equation form... How do we interpret the model?\n\n<br>\n\n$$\\widehat{Democracy}_{i} = 0.13 + 0.12 * {loggdppc}_{i}$$\n\n## Question\n\n<br>\n\nHow do we get the \"best\" values for the slope and intercept?\n\n\n## How would you draw the \"best\" line?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line-1.png){width=960}\n:::\n:::\n\n\n## How would you draw the \"best\" line?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line2-1.png){width=960}\n:::\n:::\n\n\n## Least squares regression\n\n<br>\n\n- Remember the residual is the difference between the actual value and the predicted value\n\n. . .\n\n- The regression line minimizes the sum of squared residuals.\n\n## Least squares regression\n\n<br>\n\n- Residual for each point is:  $e_i = y_i - \\hat{y}_i$\n\n- Least squares regression line minimizes $\\sum_{i = 1}^n e_i^2$.\n\n. . .\n\n- Why do we square the residual?\n\n. . .\n\n- Why not take absolute value?\n\n    - Principle: larger penalty for residuals further away\n    - Math: makes the math easier and some nice properties (not our concern here...)\n\n## Least squares regression\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line3-1.png){width=960}\n:::\n:::\n\n\n## Very Simple Example\n\nWhat should the slope and intercept be?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line4-1.png){width=960}\n:::\n:::\n\n\n\n## Example\n\n$\\hat{Y} = 0 + 1*X$\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line5-1.png){width=960}\n:::\n:::\n\n\n## Example\n\nWhat is the sum of squared residuals?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line6-1.png){width=960}\n:::\n:::\n\n\n## Example\n\nWhat is sum of squared residuals for $y = 0 + 0*X$?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line7-1.png){width=960}\n:::\n:::\n\n\n\n## Example\n\nWhat is sum of squared residuals for $y = 0 + 0*X$?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line8-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n(1-0)^2 + (2-0)^2 + (3-0)^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 14\n```\n\n\n:::\n:::\n\n\n## Example\n\nWhat is sum of squared residuals for $y = 0 + 2*X$?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line10-1.png){width=960}\n:::\n:::\n\n\n## Example\n\nWhat is sum of squared residuals for $y = 0 + 2*X$?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line11-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n(1-2)^2 + (2-4)^2 + (3-6)^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 14\n```\n\n\n:::\n:::\n\n\n\n## One more...\n\nWhat is sum of squared residuals for $y = 0 + -1*X$?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line13-1.png){width=960}\n:::\n:::\n\n\n## One more...\n\nWhat is sum of squared residuals for $y = 0 + -1*X$?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/best-line14-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n(1+1)^2 + (2+2)^2 + (3+3)^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 56\n```\n\n\n:::\n:::\n\n\n## Cost Function\n\nSum of Squared Residuals as function of possible values of $b$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/cost-function-1.png){width=960}\n:::\n:::\n\n\n\n## Least Squares Regression\n\n<br>\n\n- When we estimate a least squares regression, it is looking for the line that minimizes sum of squared residuals\n\n- In the simple example, I set $a=0$ to make it easier.  More complicated when searching for combination of $a$ and $b$ that minimize, but same basic idea\n\n## Least Squares Regression\n\n<br>\n\n- There is a way to solve for this analytically for linear regression (i.e., by doing math...)\n\n    -- They made us do this in grad school...\n\n. . .\n\n- In machine learning, people also use gradient descent algorithm in which the computer searches over possible combinations of $a$ and $b$ until it settles on the lowest point.    \n\n## Least Squares Regression\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/ssr-viz-1.png){width=960}\n:::\n:::\n\n\n## Least Squares Regression\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-5.1_files/figure-revealjs/regression-line-1.png){width=960}\n:::\n:::\n\n\n## Your Turn {.smaller}\n\n<br>\n\nAre democracies less corrupt?\n\n<br>\n\n- V-Dem includes a Political Corruption Index, which aggregates corruption in a number of spheres (see codebook for details).  \n\n- The variable name is: *v2x_corr* : lower values mean less corruption\n\n- See starter code [in classwork folder](/Users/ejt/Library/CloudStorage/Dropbox/classwork/quant4ia-summer24)\n\n\n## Your Turn {.smaller}\n\n<br>\n\n**Are democracies less corrupt?**\n\n<br>\n\n::: {.smaller}\n- Filter the V-Dem data to only include the year 2019\n- Make a scatterplot to visualize the relationship between democracy (X) and corruption (Y) (use the *v2x_libdem* variable for democracy)\n- Fit a linear model\n- Interpret results for the slope and intercept\n- For a country with the average (mean) level of democracy, what is the predicted level of corruption?\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer1\" data-update-every=\"1\" tabindex=\"0\" style=\"right:10%;bottom:5%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n## Create Your Own Model {.smaller}\n\n<br>\n\n- What is a theory that you would like to test with V-Dem data?\n- What is the dependent variable? \n- What is the independent variable? \n- Map out steps to wrangle the data and fit a regression model\n- What do you expect to find? \n- Now go ahead and wrangle the data\n- Fit the model\n- Interpret the coefficients and their significance\n- Did the results match your expectations?\n\n",
    "supporting": [
      "week-5.1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
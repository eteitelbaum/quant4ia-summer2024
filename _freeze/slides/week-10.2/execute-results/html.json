{
  "hash": "3961e0dbac29e5d5b94efb6911c6bdbc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Multiple Regression\ndate: today\ndate-format: long\nfooter: \"[IAFF 6501 Website](https://quant4ia.rocks/)\"\nlogo: images/iaff6501-logo.png\nformat:\n  revealjs:\n    theme: [simple, custom.scss]\n    transition: fade\n    slide-number: true\n    #multiplex: true\n    chalkboard: true\nexecute:\n  echo: false\n  message: false\n  warning: false\n  freeze: auto\n---\n\n\n## Load packages \n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(vdemdata)\n```\n:::\n\n\n\n## Load VDEM Data {.smaller}\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelData <- vdem |>\n  filter(year == 2006) |> \n  select(country_name, \n         libdem = v2x_libdem, \n         wealth = e_gdppc, \n         oil_rents = e_total_oil_income_pc,\n         polarization = v2cacamps, \n         corruption = v2x_corr, \n         judicial_review = v2jureview_ord, \n         region = e_regionpol_6C, \n         regime = v2x_regime) |> \n  mutate(log_wealth = log(wealth), \n         region = factor(\n           region,\n           labels=c(\"Eastern Europe\", \n             \"Latin America\", \n             \"MENA\", \n             \"SSAfrica\", \n             \"Western Europe and North America\", \n             \"Asia and Pacific\"))\n          )\n\nglimpse(modelData)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 177\nColumns: 10\n$ country_name    <chr> \"Mexico\", \"Suriname\", \"Sweden\", \"Switzerland\", \"Ghana\"…\n$ libdem          <dbl> 0.482, 0.672, 0.888, 0.845, 0.640, 0.659, 0.768, 0.018…\n$ wealth          <dbl> 14.584, 10.008, 42.378, 48.410, 3.284, 10.580, 37.068,…\n$ oil_rents       <dbl> 694.847, 639.506, 0.000, 0.000, 6.380, 10.060, 2.635, …\n$ polarization    <dbl> -0.346, -1.748, -2.346, -1.711, -0.398, -0.029, -2.273…\n$ corruption      <dbl> 0.611, 0.226, 0.004, 0.023, 0.640, 0.400, 0.107, 0.892…\n$ judicial_review <dbl> 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, …\n$ region          <fct> Latin America, Latin America, Western Europe and North…\n$ regime          <dbl> 2, 2, 3, 3, 3, 3, 3, 0, 1, 2, 1, 1, 2, 3, 2, 3, 3, 2, …\n$ log_wealth      <dbl> 2.6799250, 2.3033848, 3.7466294, 3.8797064, 1.1890622,…\n```\n\n\n:::\n:::\n\n\n## Linear Model with Multiple Predictors\n\n<br>\n\n- Previously, we were interested in GDP per capita as a predictor of democracy\n- Now, let's consider another predictor: polarization (also measured by V-Dem)\n\n## Polarization Measure in the USA\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-10.2_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n## Polarization and Democracy in 2006\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-10.2_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n## Model with One Predictor\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(libdem ~ polarization, data = modelData) |> \n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term         estimate std.error statistic  p.value\n  <chr>           <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    0.383     0.0187     20.5  2.68e-48\n2 polarization  -0.0882    0.0140     -6.29 2.45e- 9\n```\n\n\n:::\n:::\n\n<br>\n\n| How do we interpret the intercept and the slope estimate?\n| Significance? \n\n## Model with Two Predictors\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(libdem ~ polarization + log_wealth, data = modelData) |> \n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  term         estimate std.error statistic       p.value\n  <chr>           <dbl>     <dbl>     <dbl>         <dbl>\n1 (Intercept)    0.200     0.0344      5.80 0.0000000318 \n2 polarization  -0.0550    0.0139     -3.96 0.000111     \n3 log_wealth     0.0952    0.0152      6.24 0.00000000334\n```\n\n\n:::\n:::\n\n\n## Model with Two Predictors\n\n<br>\n\n$$\\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc$$ \n\n$$\\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc$$ \n\n\n## Model with Two Predictors \n\n<br>\n\n$$\\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc$$ \n\n$$\\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc$$ \n\n$a$ is the predicted level of Y when BOTH GDP per capita and polarization are equal to 0\n\n## Model with Two Predictors \n\n<br>\n\n$$\\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc$$ \n\n$$\\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc$$ \n\n- $b_1$ is the impact of a 1-unit change in polarization on the predicted level of Y, **holding GDP per capita fixed** (all else equal)\n- The relationship between polarization and democracy, controlling for wealth\n\n## Model with Two Predictors \n\n$$\\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc$$ \n\n$$\\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc$$ \n\n- $b_2$ is the impact of a 1-unit change in GDP per capita on the predicted level of Y, **holding polarization fixed** (all else equal)\n- The relationship between wealth and democracy, controlling for polarization\n\n## Model with Two Predictors\n\n<br>\n\n$$\\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc$$ \n\n\n- OLS is searching for combination of $a$, $b_1$, and $b_2$ that minimize sum of squared residuals\n- Same logic as model with one predictor, just more complicated\n\n## Model with Three Predictors \n\n<br>\n\n$$\\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc + b_3*OilRents$$ \n\n## Model with Three Predictors \n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(libdem ~ polarization + log_wealth + oil_rents, data = modelData) |> \n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  term           estimate  std.error statistic  p.value\n  <chr>             <dbl>      <dbl>     <dbl>    <dbl>\n1 (Intercept)   0.157     0.0322          4.86 2.78e- 6\n2 polarization -0.0538    0.0130         -4.13 5.87e- 5\n3 log_wealth    0.132     0.0152          8.67 4.76e-15\n4 oil_rents    -0.0000412 0.00000615     -6.70 3.39e-10\n```\n\n\n:::\n:::\n\n\n## Model with Three Predictors {.smaller}\n\n<br>\n\n$$\\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc + b_3*OilRents$$ \n\n$$\\hat{Y_i} = a + -.05*Polarization + .13*GDPpc + .00004*OilRents$$ \n<br>\n\n| $b_3$ is the impact of a 1-unit change in oil revenues per capita on the predicted level of Y, **holding polarization and GDP fixed** (all else equal)\n\n## Your Turn! {.smaller}\n\n<br>\n\n- In the last session, you examined levels of democracy and corruption\n- Now, let's fit a multiple regression model predicting corruption with two predictors: democracy (libdem) and polarization (polarization)\n- Then, interpret the coefficients\n- Estimate a second multiple regression model that adds in GDP per capita (lg_gdppc)\n- Interpret the coefficients\n- What happens to the coefficients of the other variables when we add GDP per capita to the model?\n    - Why do you think this happens?\n- Try adding in additional predictors if there is time\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer1\" data-update-every=\"1\" tabindex=\"0\" style=\"right:10%;bottom:10%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n## Model 1\n\n<br>\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  term         estimate std.error statistic  p.value\n  <chr>           <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    0.846     0.0268     31.5  7.42e-74\n2 libdem        -0.760     0.0588    -12.9  3.42e-27\n3 polarization   0.0495    0.0121      4.10 6.33e- 5\n```\n\n\n:::\n:::\n\n\n## Model 2 - Adding GDP per capita\n\n<br>\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  term         estimate std.error statistic  p.value\n  <chr>           <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    0.954     0.0283     33.8  5.21e-77\n2 libdem        -0.602     0.0576    -10.5  4.59e-20\n3 polarization   0.0332    0.0109      3.04 2.71e- 3\n4 log_wealth    -0.0846    0.0127     -6.67 3.49e-10\n```\n\n\n:::\n:::\n\n\n# Categorical Variables\n\n## Judicial Review and Democracy\n\n<br>\n\n**Judicial Review:**\n\n- Do high courts (Supreme Court, Constitutional Court, etc) have the power to rule on whether laws or policies are constitutional/legal? (Yes or No)\n- Dimension of Judicial Independence\n\n## Judicial Review and Democracy\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-10.2_files/figure-revealjs/judicial_review-1.png){width=960}\n:::\n:::\n\n\n## Judicial Review and Democracy\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(libdem ~ factor(judicial_review), data = modelData) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term                     estimate std.error statistic     p.value\n  <chr>                       <dbl>     <dbl>     <dbl>       <dbl>\n1 (Intercept)                 0.176    0.0480      3.67 0.000323   \n2 factor(judicial_review)1    0.275    0.0521      5.27 0.000000390\n```\n\n\n:::\n:::\n\n\n## Judicial Review and Democracy {.smaller}\n\n<br>\n\n$$\\widehat{Democracy_{i}} = 0.17 + 0.28*JudicialReview(yes)$$\n\n- **Slope:** countries with judicial review are expected, on average, to be 0.28 units more democratic on the liberal democracy index\n  - Compares baseline level (Judicial Review = 0) to the other level (Judicial Review = 1)\n- **Intercept:** average democracy score of countries without judicial review\n- Average democracy score of countries with judicial review is 0.17 + 0.28 = 0.45\n\n## Dummy Variables\n\n<br>\n\n- When the categorical explanatory variable has many levels, they're encoded to **dummy variables** \n- We always leave one category out of the model, as the omitted reference category\n- Each coefficient describes is the expected difference between level of the factor **and the baseline level**\n- Everything is relative to the omitted reference category\n\n## Democracy and World Region\n\n<br>\n\n- Does region predict levels of democracy?\n- Since Eastern Europe is the first category, default in R is to use that as the omitted category in models.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(modelData$region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Eastern Europe\"                   \"Latin America\"                   \n[3] \"MENA\"                             \"SSAfrica\"                        \n[5] \"Western Europe and North America\" \"Asia and Pacific\"                \n```\n\n\n:::\n:::\n\n\n## Democracy and World Region {.smaller}\n\n<br>\n\nHow should we interpret intercept?  How about the coefficient on Latin America?\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(libdem ~ region, data = modelData) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  term                                   estimate std.error statistic  p.value\n  <chr>                                     <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                              0.436     0.0362     12.0  1.54e-24\n2 regionLatin America                      0.0685    0.0537      1.28 2.04e- 1\n3 regionMENA                              -0.235     0.0573     -4.11 6.16e- 5\n4 regionSSAfrica                          -0.138     0.0458     -3.00 3.07e- 3\n5 regionWestern Europe and North America   0.373     0.0543      6.87 1.15e-10\n6 regionAsia and Pacific                  -0.134     0.0521     -2.57 1.10e- 2\n```\n\n\n:::\n:::\n\n\n## Democracy and World Region {.smaller}\n\n<br>\n\nWhat if you want a different baseline category? How do we interpret now?\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make SS Africa the reference category\nmodelData <- modelData |> \nmutate(newReg = relevel(region, ref=4)) \n\nlinear_reg() |>\n      set_engine(\"lm\") |>\n      fit(libdem ~ newReg, data = modelData) |>\n      tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  term                                   estimate std.error statistic  p.value\n  <chr>                                     <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                             0.298      0.0281   10.6    1.44e-20\n2 newRegEastern Europe                    0.138      0.0458    3.00   3.07e- 3\n3 newRegLatin America                     0.206      0.0486    4.24   3.63e- 5\n4 newRegMENA                             -0.0977     0.0525   -1.86   6.44e- 2\n5 newRegWestern Europe and North America  0.511      0.0493   10.4    7.57e-20\n6 newRegAsia and Pacific                  0.00351    0.0468    0.0750 9.40e- 1\n```\n\n\n:::\n:::\n\n\n## Your Turn\n\n<br>\n\n**Which types of regime have more corruption?**\n\n<br>\n \nV-Dem also includes a categorial regime variable: Closed autocracy (0), Electoral Autocracy (1), Electoral Democracy (2), Liberal Democracy (3)\n\n## Your Turn\n\n<br>\n\n**Which types of regime have more corruption?**\n\n<br>\n\n \nFirst, let's make this an easier factor variable to work with.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Make nicer regime factor variable\nmodelData <- modelData |> \n  mutate(regime = factor(regime,\n                         labels = c(\"Closed Autocracy\",\n                                   \"Electoral Autocracy\",\n                                  \"Electoral Democracy\",\n                                  \"Liberal Democracy\")))\nlevels(modelData$regime)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Closed Autocracy\"    \"Electoral Autocracy\" \"Electoral Democracy\"\n[4] \"Liberal Democracy\"  \n```\n\n\n:::\n:::\n\n\n## Your Turn {.smaller}\n\n<br>\n\n**Which types of regime have more corruption?**\n\n<br>\n\n- Filter data to include only the year 2019 (or run the code to use modelData)\n- Make a plot to visualize the relationship between regime type and level of corruption.          - Which kind of plot is best in this situation?\n- Fit a linear model\n- Interpret the intercept and coefficients\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer2\" data-update-every=\"1\" tabindex=\"0\" style=\"right:10%;bottom:10%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n## Visualization\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-10.2_files/figure-revealjs/corruption_plot-1.png){width=960}\n:::\n:::\n\n\n## Model\n\n<br>\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  term                      estimate std.error statistic  p.value\n  <chr>                        <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                 0.597     0.0395     15.1  1.93e-33\n2 regimeElectoral Autocracy   0.148     0.0470      3.14 1.99e- 3\n3 regimeElectoral Democracy  -0.0580    0.0486     -1.19 2.35e- 1\n4 regimeLiberal Democracy    -0.459     0.0497     -9.23 9.63e-17\n```\n\n\n:::\n:::\n\n\n## Create Your Own Model {.smaller}\n\n<br>\n\n- What is a theory that you would like to test with V-Dem data?\n- What is the dependent variable? \n- What are the independent variables? \n- Map out steps to wrangle the data and fit a regression model\n- What do you expect to find? \n- Now go ahead and wrangle the data\n- Fit the model\n- Interpret the coefficients and their significance\n- Did the results match your expectations?",
    "supporting": [
      "week-10.2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}